package dev._2lstudios.exploitfixer.bukkit.utils;

import java.util.Locale;

import org.bukkit.Server;
import org.bukkit.entity.Player;

import net.md_5.bungee.api.connection.ProxiedPlayer;

public class VersionUtil {
	private static boolean oneDotFifteen, oneDotSeven;

	public static void initialize(final Server server) {
		final String version = server.getVersion();

		oneDotFifteen = version.contains("1.15");
		oneDotSeven = version.contains("1.7");
	}

	public static String getLocale(final Player player) {
		String locale;

		try {
			player.getClass().getMethod("getLocale");
			locale = player.getLocale();
		} catch (final NoSuchMethodException exception) {
			try {
				player.spigot().getClass().getMethod("getLocale");
				locale = player.spigot().getLocale();
			} catch (final Exception exception1) {
				locale = "en";
			}
		}

		if (locale != null && locale.length() > 1) {
			return locale.substring(0, 2);
		} else {
			return "en";
		}
	}

	public static boolean isOneDotFifteen() {
		return oneDotFifteen;
	}

	public static boolean isOneDotSeven() {
		return oneDotSeven;
	}

	public static String getLocale(ProxiedPlayer player) {
		final Locale locale = player.getLocale();
		final String lang;

		if (locale != null) {
			final String localeString = locale.toString();

			if (localeString.length() > 1) {
				lang = localeString.substring(0, 2);
			} else {
				lang = "en";
			}
		} else {
			lang = "en";
		}

		return lang;
	}
}