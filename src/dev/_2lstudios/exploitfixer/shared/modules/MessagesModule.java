package dev._2lstudios.exploitfixer.shared.modules;

import dev._2lstudios.exploitfixer.shared.configuration.IConfiguration;
import dev._2lstudios.exploitfixer.shared.interfaces.IMessagesModule;
import dev._2lstudios.exploitfixer.shared.interfaces.IModule;

public class MessagesModule implements IMessagesModule {
    private final String version;
    private IConfiguration messagesYml;
    private String discord, locale;

    public MessagesModule(final String version) {
        this.version = version;
    }

    public void reload(final IConfiguration configYml, final IConfiguration messagesYml) {
        this.messagesYml = messagesYml;
        this.discord = messagesYml.getString("discord");

        final String locale = configYml.getString("locale");

        if (locale != null) {
            this.locale = locale;
        } else {
            this.locale = "en";
        }
    }

    @Override
    public String getString(final String locale, final String path) {
        final String string;

        if (messagesYml.contains(locale + path)) {
            string = messagesYml.getString(locale + path);
        } else if (messagesYml.contains(this.locale + path)) {
            string = messagesYml.getString(this.locale + path);
        } else {
            string = "";
        }

        if (string != null) {
            return string.replace("%version%", version).replace("%discord%", discord).replace('&', '\u00a7');
        } else {
            return string;
        }
    }

    public boolean isEnabled() {
        return true;
    }

    public String getName() {
        return "Messages";
    }

    public final String getReload(final String locale) {
        return getString(locale, ".commands.reload");
    }

    public final String getHelp(final String locale) {
        return getString(locale, ".commands.help");
    }

    public final String getUnknown(final String locale) {
        return getString(locale, ".commands.error.unknown");
    }

    public final String getPermission(final String locale) {
        return getString(locale, ".commands.error.permission");
    }

    public final String getConsole(final String locale) {
        return getString(locale, ".commands.error.console");
    }

    public final String getEnable(final String locale) {
        return getString(locale, ".commands.notifications.enable");
    }

    public final String getDisable(final String locale) {
        return getString(locale, ".commands.notifications.disable");
    }

    public final String getKickMessage(final IModule module, final String locale) {
        return getString(locale, ".modules." + module.getName().toLowerCase() + ".kick_message");
    }

    public final String getKickMessage(final String module, final String locale) {
        return getString(locale, ".modules." + module.toLowerCase() + ".kick_message");
    }

    public String getStats(final String locale) {
        return getString(locale, ".commands.stats");
    }
}